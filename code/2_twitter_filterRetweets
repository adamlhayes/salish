#from twitter csv files, return all twitter user mentioned by an ego

import os.path
import json
import pprint

    
with open('twitter updated nodes.txt', 'r') as f:
    seeds = f.readlines()
    

users = []
for oldname in seeds:
    newname = oldname.strip('\n')
    users.append(newname)

output_file1 = open("mentions_noRT.csv", "w", encoding="utf-8")
output_file2 = open("mentions_count.csv", "w", encoding="utf-8")

for screen_name in users:
    data = []
    with open(os.path.join(subdirectory, '{}s_tweets.json'.format(screen_name)), 'rt') as f: 
        for line in f:
            data.append(json.loads(line))
    count = 0
    for tweet in data:
        last_date = tweet['created_at']
        if 'retweeted_status' in tweet:
            continue
        if 'entities' in tweet and len(tweet['entities']['user_mentions']) > 0:
            user_mentions = tweet['entities']['user_mentions']
            for mention in user_mentions:
                count = count + 1
                screen_mention = mention['screen_name']
                print(screen_name, ',', screen_mention)
                print(screen_name.replace(' ',''), ',', screen_mention.replace(' ',''), file = output_file1)
    print(screen_name, ',', count, ',', last_date)
    print(screen_name, ',', count, ',', last_date, file = output_file2)
